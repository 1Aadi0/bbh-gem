# BBH-GEM  
**Gravito-Electromagnetic Field Extraction from Binary Black Hole Simulations**

A research-grade numerical relativity post-processing pipeline for extracting **gravito-electric** and **gravito-magnetic** curvature fields from Einstein Toolkit simulations using the DGREM formalism.

![Status](https://img.shields.io/badge/Status-Research_Grade-blue)
![Python](https://img.shields.io/badge/Python-3.8%2B-green)
[![License](https://img.shields.io/badge/License-MIT-yellow)](LICENSE)


---

## ðŸ“– Overview

This repository implements a full **Gravito-Electromagnetic (GEM)** extraction pipeline for binary black hole mergers evolved with the **Einstein Toolkit**.

It reconstructs physically correct orthonormal tetrads from BSSN/ADM data and computes the Maxwell-like curvature fields **E (tidal field)** and **B (frame-dragging field)** introduced in:

> *Unveiling the Electrodynamic Nature of Spacetime Collisions,*  
> Physical Review Letters 135, 101401 (2025)

### âš¡ Key Innovation: The Correction
A critical contribution of this codebase is the **identification and correction of a mathematical inconsistency** in the tetrad normalization definitions found in the supplemental material of *Boyeneni et al. (2025)*. 
* **The Issue:** The analytical approximation in the literature failed to satisfy orthonormality in the strong-field regime (error ~ 10^-2).
* **Our Solution:** This pipeline implements a rigorous **Gram-Schmidt orthonormalization** using the full ADM inverse metric, achieving **$10^{-16}$ (machine precision)** orthonormality.

---

## âš™ï¸ What this code does

Starting from Einstein Toolkit output, the pipeline performs:

â€¢ **HDF5 ingestion** of lapse, shift, and spatial metric  
â€¢ **Synchronization** of variables across inconsistent iteration numbers  
â€¢ **Extraction** of equatorial spacetime slices  
â€¢ **Reconstruction** of the full binary via rotational symmetry ($180^\circ$ around Z)  
â€¢ **Construction** of rigorous orthonormal tetrads on the numerical grid  
â€¢ **Computation** of Maxwell-like field tensors (E_ij, B_ij)  
â€¢ **Visualization** of field lines and frame-dragging vortices  

---

## ðŸ“‚ Repository Structure

```text
.
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ load_etk_data.py           # Low-level HDF5 I/O and iteration matching for Einstein Toolkit output
â”‚   â”œâ”€â”€ nr_snapshot_builder.py     # Builds a synchronized spacetime slice from ETK data
â”‚   â”œâ”€â”€ binary_symmetry.py         # Reconstructs the full BBH domain using 180Â° rotational symmetry
â”‚   â””â”€â”€ numerical_gem_pipeline.py  # Core GEM engine: Ghost zones resolution, tetrads, E/B fields, and plotting
â”‚
â”œâ”€â”€ archive/                       # Older development versions and experimental scripts
â”œâ”€â”€ output-0000-active/            # Example Einstein Toolkit output (not required to run the pipeline)
â”œâ”€â”€ final_data.npz                 # Extracted spacetime snapshot (generated by nr_snapshot_builder.py)
â”œâ”€â”€ README.md
â””â”€â”€ LICENSE
```
---

## How to run

### 1. Load raw Einstein Toolkit data

Run:

    python src/load_etk_data.py

This reads the raw Einstein Toolkit HDF5 output:

    admbase-lapse.h5
    admbase-shift.h5
    admbase-metric.h5

It performs:

    â€¢ Discovery of all available iterations and refinement levels
    â€¢ Loose matching between lapse, shift, and metric files
    â€¢ Selection of a common refinement level
    â€¢ Identification of a consistent reference iteration

The raw data are written to an intermediate cache for snapshot construction.

---

### 2. Build a synchronized spacetime snapshot

Run:

    python src/nr_snapshot_builder.py

This step constructs a physically meaningful spacetime slice by:

    â€¢ Extracting a single equatorial spatial plane
    â€¢ Aligning lapse, shift, and metric on the same iteration
    â€¢ Converting Carpet AMR blocks into a uniform Cartesian grid
    â€¢ Producing a consistent ADM dataset

The result is written to:

    final_data.npz

This file contains the spacetime snapshot used by all subsequent stages.

---

### 3. Reconstruct the full binary (for RotationalSymmetry180 runs)

Run:

    python src/binary_symmetry.py

Einstein Toolkit simulations are often run with RotationalSymmetry180 to reduce memory usage.
This step reconstructs the full spatial domain by rotating and stitching the half-domain data.

The output overwrites:

    final_data.npz

with the full twoâ€“blackâ€“hole geometry.

---

### 4. Compute gravito-electric and gravito-magnetic fields

Run:

    python src/numerical_gem_pipeline.py

This step:

    â€¢ Builds numerical orthonormal tetrads from the ADM metric
    â€¢ Enforces orthonormality using the full inverse 4-metric
    â€¢ Computes the DGREM field tensor
    â€¢ Extracts gravito-electric field E (tidal curvature)
    â€¢ Extracts gravito-magnetic field B (frame-dragging curvature)
    â€¢ Generates publication-quality plots

The output includes:

    â€¢ Field-line visualizations
    â€¢ Color maps of E and B
    â€¢ Binary horizon contours

These figures reproduce and extend the results of
â€œUnveiling the Electrodynamic Nature of Spacetime Collisionsâ€.

The analysis of the ringdown phase and effective GEM charges is ongoing and will be presented in forthcoming work.


---

## Requirements

This pipeline requires:

    Python 3.8+
    numpy
    h5py
    matplotlib

Install them with:

    pip install numpy h5py matplotlib


---

## How to cite

If you use this code or the tetrad-normalization corrections implemented here, please cite:

**Code**

A. Tiwari, *BBH-GEM: Numerical Relativity Post-Processing Pipeline*,  
GitHub repository (2026).  
https://github.com/1Aadi0/bbh-gem

**Methodology**

[1] S. Boyeneni, J. Wu, and E. R. Most,  
> *Unveiling the Electrodynamic Nature of Spacetime Collisions,*  
> Physical Review Letters 135, 101401 (2025)

[2] H. Olivares et al.,  
> *New first-order formulation of the Einstein equations exploiting analogies with electrodynamics,* 
> Physical Review D 105, 124038 (2022).


---

## Project status

This repository contains an active research pipeline under development.

The code is currently being used to reproduce and validate the gravito-electromagnetic field structure of binary black hole mergers from Einstein Toolkit simulations. Additional validation, optimization, and scientific analysis are ongoing.

---

## Research context

This code is part of ongoing research under Prof. Sayan Kar (IIT Kharagpur) on the geometric and electrodynamic structure of spacetime in strong-field gravity, with applications to binary black hole mergers and gravitational radiation.
